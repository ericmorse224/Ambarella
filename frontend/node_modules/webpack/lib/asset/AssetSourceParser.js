/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Yuta Hiroto @hiroppy
*/

"use strict";

const Parser = require("../Parser");

/** @typedef {import("../Module").BuildInfo***REMOVED*** BuildInfo */
/** @typedef {import("../Module").BuildMeta***REMOVED*** BuildMeta */
/** @typedef {import("../Parser").ParserState***REMOVED*** ParserState */
/** @typedef {import("../Parser").PreparsedAst***REMOVED*** PreparsedAst */

class AssetSourceParser extends Parser {
	/**
	 * @param {string | Buffer | PreparsedAst***REMOVED*** source the source to parse
	 * @param {ParserState***REMOVED*** state the parser state
	 * @returns {ParserState***REMOVED*** the parser state
	 */
	parse(source, state) {
		if (typeof source === "object" && !Buffer.isBuffer(source)) {
			throw new Error("AssetSourceParser doesn't accept preparsed AST");
		***REMOVED***
		const { module ***REMOVED*** = state;
		/** @type {BuildInfo***REMOVED*** */
		(module.buildInfo).strict = true;
		/** @type {BuildMeta***REMOVED*** */
		(module.buildMeta).exportsType = "default";
		/** @type {BuildMeta***REMOVED*** */
		(state.module.buildMeta).defaultObject = false;

		return state;
	***REMOVED***
***REMOVED***

module.exports = AssetSourceParser;
