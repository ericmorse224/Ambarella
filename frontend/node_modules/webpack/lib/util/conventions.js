/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Gengkun He @ahabhgk
*/

"use strict";

/** @typedef {import("../../declarations/WebpackOptions").CssGeneratorExportsConvention***REMOVED*** CssGeneratorExportsConvention */

/**
 * @param {string***REMOVED*** input input
 * @param {CssGeneratorExportsConvention | undefined***REMOVED*** convention convention
 * @returns {string[]***REMOVED*** results
 */
module.exports.cssExportConvention = (input, convention) => {
	const set = new Set();
	if (typeof convention === "function") {
		set.add(convention(input));
	***REMOVED*** else {
		switch (convention) {
			case "camel-case": {
				set.add(input);
				set.add(module.exports.camelCase(input));
				break;
			***REMOVED***
			case "camel-case-only": {
				set.add(module.exports.camelCase(input));
				break;
			***REMOVED***
			case "dashes": {
				set.add(input);
				set.add(module.exports.dashesCamelCase(input));
				break;
			***REMOVED***
			case "dashes-only": {
				set.add(module.exports.dashesCamelCase(input));
				break;
			***REMOVED***
			case "as-is": {
				set.add(input);
				break;
			***REMOVED***
		***REMOVED***
	***REMOVED***
	return Array.from(set);
***REMOVED***;

// Copy from css-loader
/**
 * @param {string***REMOVED*** input input
 * @returns {string***REMOVED*** result
 */
module.exports.dashesCamelCase = input =>
	input.replace(/-+(\w)/g, (match, firstLetter) => firstLetter.toUpperCase());

// Copy from css-loader
/**
 * @param {string***REMOVED*** input input
 * @returns {string***REMOVED*** result
 */
module.exports.camelCase = input => {
	let result = input.trim();

	if (result.length === 0) {
		return "";
	***REMOVED***

	if (result.length === 1) {
		return result.toLowerCase();
	***REMOVED***

	const hasUpperCase = result !== result.toLowerCase();

	if (hasUpperCase) {
		result = preserveCamelCase(result);
	***REMOVED***

	return result
		.replace(/^[_.\- ]+/, "")
		.toLowerCase()
		.replace(/[_.\- ]+([\p{Alpha***REMOVED***\p{N***REMOVED***_]|$)/gu, (_, p1) => p1.toUpperCase())
		.replace(/\d+([\p{Alpha***REMOVED***\p{N***REMOVED***_]|$)/gu, m => m.toUpperCase());
***REMOVED***;

// Copy from css-loader
/**
 * @param {string***REMOVED*** string string
 * @returns {string***REMOVED*** result
 */
const preserveCamelCase = string => {
	let result = string;
	let isLastCharLower = false;
	let isLastCharUpper = false;
	let isLastLastCharUpper = false;

	for (let i = 0; i < result.length; i++) {
		const character = result[i];

		if (isLastCharLower && /[\p{Lu***REMOVED***]/u.test(character)) {
			result = `${result.slice(0, i)***REMOVED***-${result.slice(i)***REMOVED***`;
			isLastCharLower = false;
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper = true;
			i += 1;
		***REMOVED*** else if (
			isLastCharUpper &&
			isLastLastCharUpper &&
			/[\p{Ll***REMOVED***]/u.test(character)
		) {
			result = `${result.slice(0, i - 1)***REMOVED***-${result.slice(i - 1)***REMOVED***`;
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper = false;
			isLastCharLower = true;
		***REMOVED*** else {
			isLastCharLower =
				character.toLowerCase() === character &&
				character.toUpperCase() !== character;
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper =
				character.toUpperCase() === character &&
				character.toLowerCase() !== character;
		***REMOVED***
	***REMOVED***

	return result;
***REMOVED***;
