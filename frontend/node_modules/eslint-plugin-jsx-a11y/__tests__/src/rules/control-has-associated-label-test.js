/**
 * @fileoverview Control elements must be associated with a text label
 * @author jessebeach
 */

// -----------------------------------------------------------------------------
// Requirements
// -----------------------------------------------------------------------------

import { RuleTester ***REMOVED*** from 'eslint';
import { configs ***REMOVED*** from '../../../src/index';
import parserOptionsMapper from '../../__util__/parserOptionsMapper';
import parsers from '../../__util__/helpers/parsers';
import ruleOptionsMapperFactory from '../../__util__/ruleOptionsMapperFactory';
import rule from '../../../src/rules/control-has-associated-label';

// -----------------------------------------------------------------------------
// Tests
// -----------------------------------------------------------------------------

const ruleTester = new RuleTester();

const ruleName = 'jsx-a11y/control-has-associated-label';

const expectedError = {
  message: 'A control must be associated with a text label.',
  type: 'JSXOpeningElement',
***REMOVED***;

const alwaysValid = [
  // Custom Control Components
  { code: '<CustomControl><span><span>Save</span></span></CustomControl>', options: [{ depth: 3, controlComponents: ['CustomControl'] ***REMOVED***] ***REMOVED***,
  { code: '<CustomControl><span><span label="Save"></span></span></CustomControl>', options: [{ depth: 3, controlComponents: ['CustomControl'], labelAttributes: ['label'] ***REMOVED***] ***REMOVED***,
  { code: '<CustomControl>Save</CustomControl>', settings: { 'jsx-a11y': { components: { CustomControl: 'button' ***REMOVED*** ***REMOVED*** ***REMOVED*** ***REMOVED***,
  // Interactive Elements
  { code: '<button>Save</button>' ***REMOVED***,
  { code: '<button><span>Save</span></button>' ***REMOVED***,
  { code: '<button><span><span>Save</span></span></button>', options: [{ depth: 3 ***REMOVED***] ***REMOVED***,
  { code: '<button><span><span><span><span><span><span><span><span>Save</span></span></span></span></span></span></span></span></button>', options: [{ depth: 9 ***REMOVED***] ***REMOVED***,
  { code: '<button><img alt="Save" /></button>' ***REMOVED***,
  { code: '<button aria-label="Save" />' ***REMOVED***,
  { code: '<button><span aria-label="Save" /></button>' ***REMOVED***,
  { code: '<button aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<button><span aria-labelledby="js_1" /></button>' ***REMOVED***,
  { code: '<button>{sureWhyNot***REMOVED***</button>' ***REMOVED***,
  { code: '<button><span><span label="Save"></span></span></button>', options: [{ depth: 3, labelAttributes: ['label'] ***REMOVED***] ***REMOVED***,
  { code: '<a href="#">Save</a>' ***REMOVED***,
  { code: '<area href="#">Save</area>' ***REMOVED***,
  { code: '<link>Save</link>' ***REMOVED***,
  { code: '<menuitem>Save</menuitem>' ***REMOVED***,
  { code: '<option>Save</option>' ***REMOVED***,
  { code: '<th>Save</th>' ***REMOVED***,
  // Interactive Roles
  { code: '<div role="button">Save</div>' ***REMOVED***,
  { code: '<div role="checkbox">Save</div>' ***REMOVED***,
  { code: '<div role="columnheader">Save</div>' ***REMOVED***,
  { code: '<div role="combobox">Save</div>' ***REMOVED***,
  { code: '<div role="gridcell">Save</div>' ***REMOVED***,
  { code: '<div role="link">Save</div>' ***REMOVED***,
  { code: '<div role="menuitem">Save</div>' ***REMOVED***,
  { code: '<div role="menuitemcheckbox">Save</div>' ***REMOVED***,
  { code: '<div role="menuitemradio">Save</div>' ***REMOVED***,
  { code: '<div role="option">Save</div>' ***REMOVED***,
  { code: '<div role="progressbar">Save</div>' ***REMOVED***,
  { code: '<div role="radio">Save</div>' ***REMOVED***,
  { code: '<div role="rowheader">Save</div>' ***REMOVED***,
  { code: '<div role="searchbox">Save</div>' ***REMOVED***,
  { code: '<div role="slider">Save</div>' ***REMOVED***,
  { code: '<div role="spinbutton">Save</div>' ***REMOVED***,
  { code: '<div role="switch">Save</div>' ***REMOVED***,
  { code: '<div role="tab">Save</div>' ***REMOVED***,
  { code: '<div role="textbox">Save</div>' ***REMOVED***,
  { code: '<div role="treeitem">Save</div>' ***REMOVED***,
  { code: '<div role="button" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="checkbox" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="columnheader" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="combobox" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="gridcell" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="link" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="menuitem" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="menuitemcheckbox" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="menuitemradio" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="option" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="progressbar" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="radio" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="rowheader" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="searchbox" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="slider" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="spinbutton" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="switch" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="tab" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="textbox" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="treeitem" aria-label="Save" />' ***REMOVED***,
  { code: '<div role="button" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="checkbox" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="columnheader" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="combobox" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="gridcell" aria-labelledby="Save" />' ***REMOVED***,
  { code: '<div role="link" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="menuitem" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="menuitemcheckbox" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="menuitemradio" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="option" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="progressbar" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="radio" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="rowheader" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="searchbox" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="slider" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="spinbutton" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="switch" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="tab" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="textbox" aria-labelledby="js_1" />' ***REMOVED***,
  { code: '<div role="treeitem" aria-labelledby="js_1" />' ***REMOVED***,
  // Non-interactive Elements
  { code: '<abbr />' ***REMOVED***,
  { code: '<article />' ***REMOVED***,
  { code: '<blockquote />' ***REMOVED***,
  { code: '<br />' ***REMOVED***,
  { code: '<caption />' ***REMOVED***,
  { code: '<dd />' ***REMOVED***,
  { code: '<details />' ***REMOVED***,
  { code: '<dfn />' ***REMOVED***,
  { code: '<dialog />' ***REMOVED***,
  { code: '<dir />' ***REMOVED***,
  { code: '<dl />' ***REMOVED***,
  { code: '<dt />' ***REMOVED***,
  { code: '<fieldset />' ***REMOVED***,
  { code: '<figcaption />' ***REMOVED***,
  { code: '<figure />' ***REMOVED***,
  { code: '<footer />' ***REMOVED***,
  { code: '<form />' ***REMOVED***,
  { code: '<frame />' ***REMOVED***,
  { code: '<h1 />' ***REMOVED***,
  { code: '<h2 />' ***REMOVED***,
  { code: '<h3 />' ***REMOVED***,
  { code: '<h4 />' ***REMOVED***,
  { code: '<h5 />' ***REMOVED***,
  { code: '<h6 />' ***REMOVED***,
  { code: '<hr />' ***REMOVED***,
  { code: '<iframe />' ***REMOVED***,
  { code: '<img />' ***REMOVED***,
  { code: '<label />' ***REMOVED***,
  { code: '<legend />' ***REMOVED***,
  { code: '<li />' ***REMOVED***,
  { code: '<link />' ***REMOVED***,
  { code: '<main />' ***REMOVED***,
  { code: '<mark />' ***REMOVED***,
  { code: '<marquee />' ***REMOVED***,
  { code: '<menu />' ***REMOVED***,
  { code: '<meter />' ***REMOVED***,
  { code: '<nav />' ***REMOVED***,
  { code: '<ol />' ***REMOVED***,
  { code: '<p />' ***REMOVED***,
  { code: '<pre />' ***REMOVED***,
  { code: '<progress />' ***REMOVED***,
  { code: '<ruby />' ***REMOVED***,
  { code: '<section />' ***REMOVED***,
  { code: '<table />' ***REMOVED***,
  { code: '<tbody />' ***REMOVED***,
  { code: '<tfoot />' ***REMOVED***,
  { code: '<thead />' ***REMOVED***,
  { code: '<time />' ***REMOVED***,
  { code: '<ul />' ***REMOVED***,
  // Non-interactive Roles
  { code: '<div role="alert" />' ***REMOVED***,
  { code: '<div role="alertdialog" />' ***REMOVED***,
  { code: '<div role="application" />' ***REMOVED***,
  { code: '<div role="article" />' ***REMOVED***,
  { code: '<div role="banner" />' ***REMOVED***,
  { code: '<div role="cell" />' ***REMOVED***,
  { code: '<div role="complementary" />' ***REMOVED***,
  { code: '<div role="contentinfo" />' ***REMOVED***,
  { code: '<div role="definition" />' ***REMOVED***,
  { code: '<div role="dialog" />' ***REMOVED***,
  { code: '<div role="directory" />' ***REMOVED***,
  { code: '<div role="document" />' ***REMOVED***,
  { code: '<div role="feed" />' ***REMOVED***,
  { code: '<div role="figure" />' ***REMOVED***,
  { code: '<div role="form" />' ***REMOVED***,
  { code: '<div role="group" />' ***REMOVED***,
  { code: '<div role="heading" />' ***REMOVED***,
  { code: '<div role="img" />' ***REMOVED***,
  { code: '<div role="list" />' ***REMOVED***,
  { code: '<div role="listitem" />' ***REMOVED***,
  { code: '<div role="log" />' ***REMOVED***,
  { code: '<div role="main" />' ***REMOVED***,
  { code: '<div role="marquee" />' ***REMOVED***,
  { code: '<div role="math" />' ***REMOVED***,
  { code: '<div role="navigation" />' ***REMOVED***,
  { code: '<div role="none" />' ***REMOVED***,
  { code: '<div role="note" />' ***REMOVED***,
  { code: '<div role="presentation" />' ***REMOVED***,
  { code: '<div role="region" />' ***REMOVED***,
  { code: '<div role="rowgroup" />' ***REMOVED***,
  { code: '<div role="search" />' ***REMOVED***,
  { code: '<div role="separator" />' ***REMOVED***,
  { code: '<div role="status" />' ***REMOVED***,
  { code: '<div role="table" />' ***REMOVED***,
  { code: '<div role="tabpanel" />' ***REMOVED***,
  { code: '<div role="term" />' ***REMOVED***,
  { code: '<div role="timer" />' ***REMOVED***,
  { code: '<div role="tooltip" />' ***REMOVED***,
  // Via config
  // Inputs. Ignore them because they might get a label from a wrapping label element.
  { code: '<input />' ***REMOVED***,
  { code: '<input type="button" />' ***REMOVED***,
  { code: '<input type="checkbox" />' ***REMOVED***,
  { code: '<input type="color" />' ***REMOVED***,
  { code: '<input type="date" />' ***REMOVED***,
  { code: '<input type="datetime" />' ***REMOVED***,
  { code: '<input type="email" />' ***REMOVED***,
  { code: '<input type="file" />' ***REMOVED***,
  { code: '<input type="hidden" />' ***REMOVED***,
  { code: '<input type="hidden" name="bot-field"/>' ***REMOVED***,
  { code: '<input type="hidden" name="form-name" value="Contact Form"/>' ***REMOVED***,
  { code: '<input type="image" />' ***REMOVED***,
  { code: '<input type="month" />' ***REMOVED***,
  { code: '<input type="number" />' ***REMOVED***,
  { code: '<input type="password" />' ***REMOVED***,
  { code: '<input type="radio" />' ***REMOVED***,
  { code: '<input type="range" />' ***REMOVED***,
  { code: '<input type="reset" />' ***REMOVED***,
  { code: '<input type="search" />' ***REMOVED***,
  { code: '<input type="submit" />' ***REMOVED***,
  { code: '<input type="tel" />' ***REMOVED***,
  { code: '<input type="text" />' ***REMOVED***,
  { code: '<label>Foo <input type="text" /></label>' ***REMOVED***,
  { code: '<input name={field.name***REMOVED*** id="foo" type="text" value={field.value***REMOVED*** disabled={isDisabled***REMOVED*** onChange={changeText(field.onChange, field.name)***REMOVED*** onBlur={field.onBlur***REMOVED*** />' ***REMOVED***,
  { code: '<input type="time" />' ***REMOVED***,
  { code: '<input type="url" />' ***REMOVED***,
  { code: '<input type="week" />' ***REMOVED***,
  // Marginal interactive elements. It is difficult to insist that these
  // elements contain a text label.
  { code: '<audio />' ***REMOVED***,
  { code: '<canvas />' ***REMOVED***,
  { code: '<embed />' ***REMOVED***,
  { code: '<textarea />' ***REMOVED***,
  { code: '<tr />' ***REMOVED***,
  { code: '<video />' ***REMOVED***,
  // Interactive roles to ignore
  { code: '<div role="grid" />' ***REMOVED***,
  { code: '<div role="listbox" />' ***REMOVED***,
  { code: '<div role="menu" />' ***REMOVED***,
  { code: '<div role="menubar" />' ***REMOVED***,
  { code: '<div role="radiogroup" />' ***REMOVED***,
  { code: '<div role="row" />' ***REMOVED***,
  { code: '<div role="tablist" />' ***REMOVED***,
  { code: '<div role="toolbar" />' ***REMOVED***,
  { code: '<div role="tree" />' ***REMOVED***,
  { code: '<div role="treegrid" />' ***REMOVED***,
];
const neverValid = [
  { code: '<button />', errors: [expectedError] ***REMOVED***,
  { code: '<button><span /></button>', errors: [expectedError] ***REMOVED***,
  { code: '<button><img /></button>', errors: [expectedError] ***REMOVED***,
  { code: '<button><span title="This is not a real label" /></button>', errors: [expectedError] ***REMOVED***,
  { code: '<button><span><span><span>Save</span></span></span></button>', options: [{ depth: 3 ***REMOVED***], errors: [expectedError] ***REMOVED***,
  { code: '<CustomControl><span><span></span></span></CustomControl>', options: [{ depth: 3, controlComponents: ['CustomControl'] ***REMOVED***], errors: [expectedError] ***REMOVED***,
  { code: '<CustomControl></CustomControl>', errors: [expectedError], settings: { 'jsx-a11y': { components: { CustomControl: 'button' ***REMOVED*** ***REMOVED*** ***REMOVED*** ***REMOVED***,
  { code: '<a href="#" />', errors: [expectedError] ***REMOVED***,
  { code: '<area href="#" />', errors: [expectedError] ***REMOVED***,
  { code: '<menuitem />', errors: [expectedError] ***REMOVED***,
  { code: '<option />', errors: [expectedError] ***REMOVED***,
  { code: '<th />', errors: [expectedError] ***REMOVED***,
  { code: '<td />', errors: [expectedError] ***REMOVED***,
  // Interactive Roles
  { code: '<div role="button" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="checkbox" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="columnheader" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="combobox" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="link" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="gridcell" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="menuitem" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="menuitemcheckbox" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="menuitemradio" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="option" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="progressbar" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="radio" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="rowheader" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="scrollbar" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="searchbox" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="slider" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="spinbutton" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="switch" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="tab" />', errors: [expectedError] ***REMOVED***,
  { code: '<div role="textbox" />', errors: [expectedError] ***REMOVED***,
];

const recommendedOptions = (configs.recommended.rules[ruleName][1] || {***REMOVED***);
ruleTester.run(`${ruleName***REMOVED***:recommended`, rule, {
  valid: parsers.all([].concat(
    ...alwaysValid,
  ))
    .map(ruleOptionsMapperFactory(recommendedOptions))
    .map(parserOptionsMapper),
  invalid: parsers.all([].concat(
    ...neverValid,
  ))
    .map(ruleOptionsMapperFactory(recommendedOptions))
    .map(parserOptionsMapper),
***REMOVED***);

const strictOptions = (configs.strict.rules[ruleName][1] || {***REMOVED***);
ruleTester.run(`${ruleName***REMOVED***:strict`, rule, {
  valid: parsers.all([].concat(
    ...alwaysValid,
  ))
    .map(ruleOptionsMapperFactory(strictOptions))
    .map(parserOptionsMapper),
  invalid: parsers.all([].concat(
    ...neverValid,
  ))
    .map(ruleOptionsMapperFactory(strictOptions))
    .map(parserOptionsMapper),
***REMOVED***);

ruleTester.run(`${ruleName***REMOVED***:no-config`, rule, {
  valid: parsers.all([].concat(
    { code: '<input type="hidden" />' ***REMOVED***,
    { code: '<input type="text" aria-hidden="true" />' ***REMOVED***,
  ))
    .map(parserOptionsMapper),
  invalid: parsers.all([].concat(
    { code: '<input type="text" />', errors: [expectedError] ***REMOVED***,
  ))
    .map(parserOptionsMapper),
***REMOVED***);
