"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
***REMOVED***);
exports.default = parser;
function _parser() {
  const data = require("@babel/parser");
  _parser = function () {
    return data;
  ***REMOVED***;
  return data;
***REMOVED***
function _codeFrame() {
  const data = require("@babel/code-frame");
  _codeFrame = function () {
    return data;
  ***REMOVED***;
  return data;
***REMOVED***
var _missingPluginHelper = require("./util/missing-plugin-helper.js");
function* parser(pluginPasses, {
  parserOpts,
  highlightCode = true,
  filename = "unknown"
***REMOVED***, code) {
  try {
    const results = [];
    for (const plugins of pluginPasses) {
      for (const plugin of plugins) {
        const {
          parserOverride
        ***REMOVED*** = plugin;
        if (parserOverride) {
          const ast = parserOverride(code, parserOpts, _parser().parse);
          if (ast !== undefined) results.push(ast);
        ***REMOVED***
      ***REMOVED***
    ***REMOVED***
    if (results.length === 0) {
      return (0, _parser().parse)(code, parserOpts);
    ***REMOVED*** else if (results.length === 1) {
      yield* [];
      if (typeof results[0].then === "function") {
        throw new Error(`You appear to be using an async parser plugin, ` + `which your current version of Babel does not support. ` + `If you're using a published plugin, you may need to upgrade ` + `your @babel/core version.`);
      ***REMOVED***
      return results[0];
    ***REMOVED***
    throw new Error("More than one plugin attempted to override parsing.");
  ***REMOVED*** catch (err) {
    if (err.code === "BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED") {
      err.message += "\nConsider renaming the file to '.mjs', or setting sourceType:module " + "or sourceType:unambiguous in your Babel config for this file.";
    ***REMOVED***
    const {
      loc,
      missingPlugin
    ***REMOVED*** = err;
    if (loc) {
      const codeFrame = (0, _codeFrame().codeFrameColumns)(code, {
        start: {
          line: loc.line,
          column: loc.column + 1
        ***REMOVED***
      ***REMOVED***, {
        highlightCode
      ***REMOVED***);
      if (missingPlugin) {
        err.message = `${filename***REMOVED***: ` + (0, _missingPluginHelper.default)(missingPlugin[0], loc, codeFrame, filename);
      ***REMOVED*** else {
        err.message = `${filename***REMOVED***: ${err.message***REMOVED***\n\n` + codeFrame;
      ***REMOVED***
      err.code = "BABEL_PARSE_ERROR";
    ***REMOVED***
    throw err;
  ***REMOVED***
***REMOVED***
0 && 0;

//# sourceMappingURL=index.js.map
