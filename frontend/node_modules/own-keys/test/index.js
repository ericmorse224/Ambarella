'use strict';

var test = require('tape');
var hasSymbols = require('has-symbols/shams')();
var hasPropertyDescriptors = require('has-property-descriptors')();

var ownKeys = require('../');

/** @type {(a: PropertyKey, b: PropertyKey) => number***REMOVED*** */
function comparator(a, b) {
	if (typeof a === 'string' && typeof b === 'string') {
		return a.localeCompare(b);
	***REMOVED***
	if (typeof a === 'number' && typeof b === 'number') {
		return a - b;
	***REMOVED***
	return typeof a === 'symbol' ? 1 : -1;
***REMOVED***

test('ownKeys', function (t) {
	t.equal(typeof ownKeys, 'function', 'is a function');
	t.equal(
		ownKeys.length,
		1,
		'has a length of 1'
	);

	t.test('basics', function (st) {
		var obj = { a: 1, b: 2 ***REMOVED***;
		if (hasPropertyDescriptors) {
			Object.defineProperty(obj, 'c', {
				configurable: true,
				enumerable: false,
				writable: true,
				value: 3
			***REMOVED***);
		***REMOVED***

		st.deepEqual(
			ownKeys(obj).sort(comparator),
			(hasPropertyDescriptors ? ['a', 'b', 'c'] : ['a', 'b']).sort(comparator),
			'includes non-enumerable properties'
		);

		st.end();
	***REMOVED***);

	t.test('symbols', { skip: !hasSymbols ***REMOVED***, function (st) {
		/** @type {Record<PropertyKey, unknown>***REMOVED*** */
		var obj = { a: 1 ***REMOVED***;
		var sym = Symbol('b');
		obj[sym] = 2;

		var nonEnumSym = Symbol('c');
		Object.defineProperty(obj, nonEnumSym, {
			configurable: true,
			enumerable: false,
			writable: true,
			value: 3
		***REMOVED***);

		st.deepEqual(
			ownKeys(obj).sort(comparator),
			['a', sym, nonEnumSym].sort(comparator),
			'works with symbols, both enum and non-enum'
		);

		st.end();
	***REMOVED***);

	t.end();
***REMOVED***);
