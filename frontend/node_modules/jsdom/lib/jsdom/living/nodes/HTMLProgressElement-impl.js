"use strict";

const HTMLElementImpl = require("./HTMLElement-impl").implementation;
const { getLabelsForLabelable ***REMOVED*** = require("../helpers/form-controls");
const { parseFloatingPointNumber ***REMOVED*** = require("../helpers/strings");

class HTMLProgressElementImpl extends HTMLElementImpl {
  constructor(globalObject, args, privateData) {
    super(globalObject, args, privateData);
    this._labels = null;
  ***REMOVED***

  get _isDeterminate() {
    return this.hasAttributeNS(null, "value");
  ***REMOVED***

  // https://html.spec.whatwg.org/multipage/form-elements.html#concept-progress-value
  get _value() {
    const valueAttr = this.getAttributeNS(null, "value");
    const parsedValue = parseFloatingPointNumber(valueAttr);
    if (parsedValue !== null && parsedValue > 0) {
      return parsedValue;
    ***REMOVED***
    return 0;
  ***REMOVED***

  // https://html.spec.whatwg.org/multipage/form-elements.html#concept-progress-current-value
  get _currentValue() {
    const value = this._value;
    return value > this.max ? this.max : value;
  ***REMOVED***

  get value() {
    if (this._isDeterminate) {
      return this._currentValue;
    ***REMOVED***
    return 0;
  ***REMOVED***
  set value(value) {
    this.setAttributeNS(null, "value", value);
  ***REMOVED***

  get max() {
    const max = this.getAttributeNS(null, "max");
    if (max !== null) {
      const parsedMax = parseFloatingPointNumber(max);
      if (parsedMax !== null && parsedMax > 0) {
        return parsedMax;
      ***REMOVED***
    ***REMOVED***
    return 1.0;
  ***REMOVED***
  set max(value) {
    if (value > 0) {
      this.setAttributeNS(null, "max", value);
    ***REMOVED***
  ***REMOVED***

  get position() {
    if (!this._isDeterminate) {
      return -1;
    ***REMOVED***

    return this._currentValue / this.max;
  ***REMOVED***

  get labels() {
    return getLabelsForLabelable(this);
  ***REMOVED***
***REMOVED***

module.exports = {
  implementation: HTMLProgressElementImpl
***REMOVED***;
