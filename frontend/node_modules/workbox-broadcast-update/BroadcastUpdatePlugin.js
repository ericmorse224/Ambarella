/*
  Copyright 2018 Google LLC

  Use of this source code is governed by an MIT-style
  license that can be found in the LICENSE file or at
  https://opensource.org/licenses/MIT.
*/
import { dontWaitFor ***REMOVED*** from 'workbox-core/_private/dontWaitFor.js';
import { BroadcastCacheUpdate, ***REMOVED*** from './BroadcastCacheUpdate.js';
import './_version.js';
/**
 * This plugin will automatically broadcast a message whenever a cached response
 * is updated.
 *
 * @memberof workbox-broadcast-update
 */
class BroadcastUpdatePlugin {
    /**
     * Construct a {@link workbox-broadcast-update.BroadcastUpdate***REMOVED*** instance with
     * the passed options and calls its `notifyIfUpdated` method whenever the
     * plugin's `cacheDidUpdate` callback is invoked.
     *
     * @param {Object***REMOVED*** [options]
     * @param {Array<string>***REMOVED*** [options.headersToCheck=['content-length', 'etag', 'last-modified']]
     *     A list of headers that will be used to determine whether the responses
     *     differ.
     * @param {string***REMOVED*** [options.generatePayload] A function whose return value
     *     will be used as the `payload` field in any cache update messages sent
     *     to the window clients.
     */
    constructor(options) {
        /**
         * A "lifecycle" callback that will be triggered automatically by the
         * `workbox-sw` and `workbox-runtime-caching` handlers when an entry is
         * added to a cache.
         *
         * @private
         * @param {Object***REMOVED*** options The input object to this function.
         * @param {string***REMOVED*** options.cacheName Name of the cache being updated.
         * @param {Response***REMOVED*** [options.oldResponse] The previous cached value, if any.
         * @param {Response***REMOVED*** options.newResponse The new value in the cache.
         * @param {Request***REMOVED*** options.request The request that triggered the update.
         * @param {Request***REMOVED*** options.event The event that triggered the update.
         */
        this.cacheDidUpdate = async (options) => {
            dontWaitFor(this._broadcastUpdate.notifyIfUpdated(options));
        ***REMOVED***;
        this._broadcastUpdate = new BroadcastCacheUpdate(options);
    ***REMOVED***
***REMOVED***
export { BroadcastUpdatePlugin ***REMOVED***;
