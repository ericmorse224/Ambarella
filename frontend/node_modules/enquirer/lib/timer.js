'use strict';

module.exports = prompt => {
  prompt.timers = prompt.timers || {***REMOVED***;

  let timers = prompt.options.timers;
  if (!timers) return;

  for (let key of Object.keys(timers)) {
    let opts = timers[key];
    if (typeof opts === 'number') {
      opts = { interval: opts ***REMOVED***;
    ***REMOVED***
    create(prompt, key, opts);
  ***REMOVED***
***REMOVED***;

function create(prompt, name, options = {***REMOVED***) {
  let timer = prompt.timers[name] = { name, start: Date.now(), ms: 0, tick: 0 ***REMOVED***;
  let ms = options.interval || 120;
  timer.frames = options.frames || [];
  timer.loading = true;

  let interval = setInterval(() => {
    timer.ms = Date.now() - timer.start;
    timer.tick++;
    prompt.render();
  ***REMOVED***, ms);

  timer.stop = () => {
    timer.loading = false;
    clearInterval(interval);
  ***REMOVED***;

  Reflect.defineProperty(timer, 'interval', { value: interval ***REMOVED***);
  prompt.once('close', () => timer.stop());
  return timer.stop;
***REMOVED***
