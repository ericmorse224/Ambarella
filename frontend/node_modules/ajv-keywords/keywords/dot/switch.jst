{{# def.definitions ***REMOVED******REMOVED***
{{# def.errors ***REMOVED******REMOVED***
{{# def.setupKeyword ***REMOVED******REMOVED***
{{# def.setupNextLevel ***REMOVED******REMOVED***


{{## def.validateIf:
  {{# def.setCompositeRule ***REMOVED******REMOVED***
  {{ $it.createErrors = false; ***REMOVED******REMOVED***
  {{# def._validateSwitchRule:if ***REMOVED******REMOVED***
  {{ $it.createErrors = true; ***REMOVED******REMOVED***
  {{# def.resetCompositeRule ***REMOVED******REMOVED***
  {{=$ifPassed***REMOVED******REMOVED*** = {{=$nextValid***REMOVED******REMOVED***;
#***REMOVED******REMOVED***

{{## def.validateThen:
  {{? typeof $sch.then == 'boolean' ***REMOVED******REMOVED***
    {{? $sch.then === false ***REMOVED******REMOVED***
      {{# def.error:'switch' ***REMOVED******REMOVED***
    {{?***REMOVED******REMOVED***
    var {{=$nextValid***REMOVED******REMOVED*** = {{= $sch.then ***REMOVED******REMOVED***;
  {{??***REMOVED******REMOVED***
    {{# def._validateSwitchRule:then ***REMOVED******REMOVED***
  {{?***REMOVED******REMOVED***
#***REMOVED******REMOVED***

{{## def._validateSwitchRule:_clause:
  {{
    $it.schema = $sch._clause;
    $it.schemaPath = $schemaPath + '[' + $caseIndex + ']._clause';
    $it.errSchemaPath = $errSchemaPath + '/' + $caseIndex + '/_clause';
  ***REMOVED******REMOVED***
  {{# def.insertSubschemaCode ***REMOVED******REMOVED***
#***REMOVED******REMOVED***

{{## def.switchCase:
  {{? $sch.if && {{# def.nonEmptySchema:$sch.if ***REMOVED******REMOVED*** ***REMOVED******REMOVED***
    var {{=$errs***REMOVED******REMOVED*** = errors;
    {{# def.validateIf ***REMOVED******REMOVED***
    if ({{=$ifPassed***REMOVED******REMOVED***) {
      {{# def.validateThen ***REMOVED******REMOVED***  
    ***REMOVED*** else {
      {{# def.resetErrors ***REMOVED******REMOVED***
    ***REMOVED***
  {{??***REMOVED******REMOVED***
    {{=$ifPassed***REMOVED******REMOVED*** = true;
    {{# def.validateThen ***REMOVED******REMOVED***
  {{?***REMOVED******REMOVED***
#***REMOVED******REMOVED***


{{
  var $ifPassed = 'ifPassed' + it.level
    , $currentBaseId = $it.baseId
    , $shouldContinue;
***REMOVED******REMOVED***
var {{=$ifPassed***REMOVED******REMOVED***;

{{~ $schema:$sch:$caseIndex ***REMOVED******REMOVED***
  {{? $caseIndex && !$shouldContinue ***REMOVED******REMOVED***
    if (!{{=$ifPassed***REMOVED******REMOVED***) {
    {{ $closingBraces+= '***REMOVED***'; ***REMOVED******REMOVED***
  {{?***REMOVED******REMOVED***

  {{# def.switchCase ***REMOVED******REMOVED***
  {{ $shouldContinue = $sch.continue ***REMOVED******REMOVED***
{{~***REMOVED******REMOVED***

{{= $closingBraces ***REMOVED******REMOVED***

var {{=$valid***REMOVED******REMOVED*** = {{=$nextValid***REMOVED******REMOVED***;
