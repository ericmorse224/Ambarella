var TYPE = require('../tokenizer').TYPE;
var WHITESPACE = TYPE.WhiteSpace;
var COMMENT = TYPE.Comment;

module.exports = function readSequence(recognizer) {
    var children = this.createList();
    var child = null;
    var context = {
        recognizer: recognizer,
        space: null,
        ignoreWS: false,
        ignoreWSAfter: false
    ***REMOVED***;

    this.scanner.skipSC();

    while (!this.scanner.eof) {
        switch (this.scanner.tokenType) {
            case COMMENT:
                this.scanner.next();
                continue;

            case WHITESPACE:
                if (context.ignoreWS) {
                    this.scanner.next();
                ***REMOVED*** else {
                    context.space = this.WhiteSpace();
                ***REMOVED***
                continue;
        ***REMOVED***

        child = recognizer.getNode.call(this, context);

        if (child === undefined) {
            break;
        ***REMOVED***

        if (context.space !== null) {
            children.push(context.space);
            context.space = null;
        ***REMOVED***

        children.push(child);

        if (context.ignoreWSAfter) {
            context.ignoreWSAfter = false;
            context.ignoreWS = true;
        ***REMOVED*** else {
            context.ignoreWS = false;
        ***REMOVED***
    ***REMOVED***

    return children;
***REMOVED***;
