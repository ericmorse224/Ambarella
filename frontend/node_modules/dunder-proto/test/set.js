'use strict';

var test = require('tape');

var setDunderProto = require('../set');

test('setDunderProto', { skip: !setDunderProto ***REMOVED***, function (t) {
	if (!setDunderProto) {
		throw 'should never happen; this is just for type narrowing'; // eslint-disable-line no-throw-literal
	***REMOVED***

	// @ts-expect-error
	t['throws'](function () { setDunderProto(); ***REMOVED***, TypeError, 'throws if no arguments');
	// @ts-expect-error
	t['throws'](function () { setDunderProto(undefined); ***REMOVED***, TypeError, 'throws with undefined and nothing');
	// @ts-expect-error
	t['throws'](function () { setDunderProto(undefined, undefined); ***REMOVED***, TypeError, 'throws with undefined and undefined');
	// @ts-expect-error
	t['throws'](function () { setDunderProto(null); ***REMOVED***, TypeError, 'throws with null and undefined');
	// @ts-expect-error
	t['throws'](function () { setDunderProto(null, undefined); ***REMOVED***, TypeError, 'throws with null and undefined');

	/** @type {{ inherited?: boolean ***REMOVED******REMOVED*** */
	var obj = {***REMOVED***;
	t.ok('toString' in obj, 'object initially has toString');

	setDunderProto(obj, null);
	t.notOk('toString' in obj, 'object no longer has toString');

	t.notOk('inherited' in obj, 'object lacks inherited property');
	setDunderProto(obj, { inherited: true ***REMOVED***);
	t.equal(obj.inherited, true, 'object has inherited property');

	t.end();
***REMOVED***);

test('no dunder proto', { skip: !!setDunderProto ***REMOVED***, function (t) {
	if ('__proto__' in Object.prototype) {
		t['throws'](
			// @ts-expect-error
			function () { ({***REMOVED***).__proto__ = null; ***REMOVED***, // eslint-disable-line no-proto
			Error,
			'throws when setting Object.prototype.__proto__'
		);
	***REMOVED*** else {
		t.notOk('__proto__' in Object.prototype, 'no __proto__ in Object.prototype');
	***REMOVED***

	t.end();
***REMOVED***);
