{{# def.definitions ***REMOVED******REMOVED***
{{# def.errors ***REMOVED******REMOVED***
{{# def.missing ***REMOVED******REMOVED***
{{# def.setupKeyword ***REMOVED******REMOVED***
{{# def.$data ***REMOVED******REMOVED***

{{ var $vSchema = 'schema' + $lvl; ***REMOVED******REMOVED***

{{## def.setupLoop:
  {{? !$isData ***REMOVED******REMOVED***
    var {{=$vSchema***REMOVED******REMOVED*** = validate.schema{{=$schemaPath***REMOVED******REMOVED***;
  {{?***REMOVED******REMOVED***

  {{
    var $i = 'i' + $lvl
      , $propertyPath = 'schema' + $lvl + '[' + $i + ']'
      , $missingProperty = '\' + ' + $propertyPath + ' + \'';
    if (it.opts._errorDataPathProperty) {
      it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);
    ***REMOVED***
  ***REMOVED******REMOVED***
#***REMOVED******REMOVED***


{{## def.isRequiredOwnProperty:
  Object.prototype.hasOwnProperty.call({{=$data***REMOVED******REMOVED***, {{=$vSchema***REMOVED******REMOVED***[{{=$i***REMOVED******REMOVED***])
#***REMOVED******REMOVED***


{{? !$isData ***REMOVED******REMOVED***
  {{? $schema.length < it.opts.loopRequired &&
      it.schema.properties && Object.keys(it.schema.properties).length ***REMOVED******REMOVED***
    {{ var $required = []; ***REMOVED******REMOVED***
    {{~ $schema:$property ***REMOVED******REMOVED***
      {{ var $propertySch = it.schema.properties[$property]; ***REMOVED******REMOVED***
      {{? !($propertySch && {{# def.nonEmptySchema:$propertySch***REMOVED******REMOVED***) ***REMOVED******REMOVED***
        {{ $required[$required.length] = $property; ***REMOVED******REMOVED***
      {{?***REMOVED******REMOVED***
    {{~***REMOVED******REMOVED***
  {{??***REMOVED******REMOVED***
    {{ var $required = $schema; ***REMOVED******REMOVED***
  {{?***REMOVED******REMOVED***
{{?***REMOVED******REMOVED***


{{? $isData || $required.length ***REMOVED******REMOVED***
  {{
    var $currentErrorPath = it.errorPath
      , $loopRequired = $isData || $required.length >= it.opts.loopRequired
      , $ownProperties = it.opts.ownProperties;
  ***REMOVED******REMOVED***

  {{? $breakOnError ***REMOVED******REMOVED***
    var missing{{=$lvl***REMOVED******REMOVED***;
    {{? $loopRequired ***REMOVED******REMOVED***
      {{# def.setupLoop ***REMOVED******REMOVED***
      var {{=$valid***REMOVED******REMOVED*** = true;

      {{?$isData***REMOVED******REMOVED***{{# def.check$dataIsArray ***REMOVED******REMOVED***{{?***REMOVED******REMOVED***

      for (var {{=$i***REMOVED******REMOVED*** = 0; {{=$i***REMOVED******REMOVED*** < {{=$vSchema***REMOVED******REMOVED***.length; {{=$i***REMOVED******REMOVED***++) {
        {{=$valid***REMOVED******REMOVED*** = {{=$data***REMOVED******REMOVED***[{{=$vSchema***REMOVED******REMOVED***[{{=$i***REMOVED******REMOVED***]] !== undefined
                      {{? $ownProperties ***REMOVED******REMOVED***
                        && {{# def.isRequiredOwnProperty ***REMOVED******REMOVED***
                      {{?***REMOVED******REMOVED***;
        if (!{{=$valid***REMOVED******REMOVED***) break;
      ***REMOVED***

      {{? $isData ***REMOVED******REMOVED***  ***REMOVED***  {{?***REMOVED******REMOVED***

      {{# def.checkError:'required' ***REMOVED******REMOVED***
      else {
    {{??***REMOVED******REMOVED***
      if ({{# def.checkMissingProperty:$required ***REMOVED******REMOVED***) {
        {{# def.errorMissingProperty:'required' ***REMOVED******REMOVED***
      ***REMOVED*** else {
    {{?***REMOVED******REMOVED***
  {{??***REMOVED******REMOVED***
    {{? $loopRequired ***REMOVED******REMOVED***
      {{# def.setupLoop ***REMOVED******REMOVED***
      {{? $isData ***REMOVED******REMOVED***
        if ({{=$vSchema***REMOVED******REMOVED*** && !Array.isArray({{=$vSchema***REMOVED******REMOVED***)) {
          {{# def.addError:'required' ***REMOVED******REMOVED***
        ***REMOVED*** else if ({{=$vSchema***REMOVED******REMOVED*** !== undefined) {
      {{?***REMOVED******REMOVED***

      for (var {{=$i***REMOVED******REMOVED*** = 0; {{=$i***REMOVED******REMOVED*** < {{=$vSchema***REMOVED******REMOVED***.length; {{=$i***REMOVED******REMOVED***++) {
        if ({{=$data***REMOVED******REMOVED***[{{=$vSchema***REMOVED******REMOVED***[{{=$i***REMOVED******REMOVED***]] === undefined
            {{? $ownProperties ***REMOVED******REMOVED***
              || !{{# def.isRequiredOwnProperty ***REMOVED******REMOVED***
            {{?***REMOVED******REMOVED***) {
          {{# def.addError:'required' ***REMOVED******REMOVED***
        ***REMOVED***
      ***REMOVED***

      {{? $isData ***REMOVED******REMOVED***  ***REMOVED***  {{?***REMOVED******REMOVED***
    {{??***REMOVED******REMOVED***
      {{~ $required:$propertyKey ***REMOVED******REMOVED***
        {{# def.allErrorsMissingProperty:'required' ***REMOVED******REMOVED***
      {{~***REMOVED******REMOVED***
    {{?***REMOVED******REMOVED***
  {{?***REMOVED******REMOVED***

  {{ it.errorPath = $currentErrorPath; ***REMOVED******REMOVED***

{{?? $breakOnError ***REMOVED******REMOVED***
  if (true) {
{{?***REMOVED******REMOVED***
