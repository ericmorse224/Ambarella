function createPlugin(plugin, config) {
  return {
    handler: plugin,
    config,
  ***REMOVED***
***REMOVED***

createPlugin.withOptions = function (pluginFunction, configFunction = () => ({***REMOVED***)) {
  const optionsFunction = function (options) {
    return {
      __options: options,
      handler: pluginFunction(options),
      config: configFunction(options),
    ***REMOVED***
  ***REMOVED***

  optionsFunction.__isOptionsFunction = true

  // Expose plugin dependencies so that `object-hash` returns a different
  // value if anything here changes, to ensure a rebuild is triggered.
  optionsFunction.__pluginFunction = pluginFunction
  optionsFunction.__configFunction = configFunction

  return optionsFunction
***REMOVED***

export default createPlugin
