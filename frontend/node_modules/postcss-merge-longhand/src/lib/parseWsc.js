'use strict';
const { list ***REMOVED*** = require('postcss');
const { isWidth, isStyle, isColor ***REMOVED*** = require('./validateWsc.js');

const none = /^\s*(none|medium)(\s+none(\s+(none|currentcolor))?)?\s*$/i;

/* Approximate https://drafts.csswg.org/css-values-4/#typedef-dashed-ident */
// eslint-disable-next-line no-control-regex
const varRE = /--(\w|-|[^\x00-\x7F])+/g;
/** @type {(v: string) => string***REMOVED*** */
const toLower = (v) => {
  let match;
  let lastIndex = 0;
  let result = '';
  varRE.lastIndex = 0;
  while ((match = varRE.exec(v)) !== null) {
    if (match.index > lastIndex) {
      result += v.substring(lastIndex, match.index).toLowerCase();
    ***REMOVED***
    result += match[0];
    lastIndex = match.index + match[0].length;
  ***REMOVED***
  if (lastIndex < v.length) {
    result += v.substring(lastIndex).toLowerCase();
  ***REMOVED***
  if (result === '') {
    return v;
  ***REMOVED***
  return result;
***REMOVED***;

/**
 * @param {string***REMOVED*** value
 * @return {[string, string, string]***REMOVED***
 */
module.exports = function parseWsc(value) {
  if (none.test(value)) {
    return ['medium', 'none', 'currentcolor'];
  ***REMOVED***

  let width, style, color;

  const values = list.space(value);
  if (
    values.length > 1 &&
    isStyle(values[1]) &&
    values[0].toLowerCase() === 'none'
  ) {
    values.unshift();
    width = '0';
  ***REMOVED***

  /** @type {string[]***REMOVED*** */
  const unknown = [];

  values.forEach((v) => {
    if (isStyle(v)) {
      style = toLower(v);
    ***REMOVED*** else if (isWidth(v)) {
      width = toLower(v);
    ***REMOVED*** else if (isColor(v)) {
      color = toLower(v);
    ***REMOVED*** else {
      unknown.push(v);
    ***REMOVED***
  ***REMOVED***);

  if (unknown.length) {
    if (!width && style && color) {
      width = unknown.pop();
    ***REMOVED***

    if (width && !style && color) {
      style = unknown.pop();
    ***REMOVED***

    if (width && style && !color) {
      color = unknown.pop();
    ***REMOVED***
  ***REMOVED***

  return /** @type {[string, string, string]***REMOVED*** */ ([width, style, color]);
***REMOVED***;
