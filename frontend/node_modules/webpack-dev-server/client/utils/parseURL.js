import getCurrentScriptSource from "./getCurrentScriptSource.js";

/**
 * @param {string***REMOVED*** resourceQuery
 * @returns {{ [key: string]: string | boolean ***REMOVED******REMOVED***
 */
function parseURL(resourceQuery) {
  /** @type {{ [key: string]: string ***REMOVED******REMOVED*** */
  var options = {***REMOVED***;
  if (typeof resourceQuery === "string" && resourceQuery !== "") {
    var searchParams = resourceQuery.slice(1).split("&");
    for (var i = 0; i < searchParams.length; i++) {
      var pair = searchParams[i].split("=");
      options[pair[0]] = decodeURIComponent(pair[1]);
    ***REMOVED***
  ***REMOVED*** else {
    // Else, get the url from the <script> this file was called with.
    var scriptSource = getCurrentScriptSource();
    var scriptSourceURL;
    try {
      // The placeholder `baseURL` with `window.location.href`,
      // is to allow parsing of path-relative or protocol-relative URLs,
      // and will have no effect if `scriptSource` is a fully valid URL.
      scriptSourceURL = new URL(scriptSource, self.location.href);
    ***REMOVED*** catch (error) {
      // URL parsing failed, do nothing.
      // We will still proceed to see if we can recover using `resourceQuery`
    ***REMOVED***
    if (scriptSourceURL) {
      options = scriptSourceURL;
      options.fromCurrentScript = true;
    ***REMOVED***
  ***REMOVED***
  return options;
***REMOVED***
export default parseURL;