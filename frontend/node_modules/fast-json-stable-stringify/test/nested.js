'use strict';

var test = require('tape');
var stringify = require('../');

test('nested', function (t) {
    t.plan(1);
    var obj = { c: 8, b: [{z:6,y:5,x:4***REMOVED***,7], a: 3 ***REMOVED***;
    t.equal(stringify(obj), '{"a":3,"b":[{"x":4,"y":5,"z":6***REMOVED***,7],"c":8***REMOVED***');
***REMOVED***);

test('cyclic (default)', function (t) {
    t.plan(1);
    var one = { a: 1 ***REMOVED***;
    var two = { a: 2, one: one ***REMOVED***;
    one.two = two;
    try {
        stringify(one);
    ***REMOVED*** catch (ex) {
        t.equal(ex.toString(), 'TypeError: Converting circular structure to JSON');
    ***REMOVED***
***REMOVED***);

test('cyclic (specifically allowed)', function (t) {
    t.plan(1);
    var one = { a: 1 ***REMOVED***;
    var two = { a: 2, one: one ***REMOVED***;
    one.two = two;
    t.equal(stringify(one, {cycles:true***REMOVED***), '{"a":1,"two":{"a":2,"one":"__cycle__"***REMOVED******REMOVED***');
***REMOVED***);

test('repeated non-cyclic value', function(t) {
    t.plan(1);
    var one = { x: 1 ***REMOVED***;
    var two = { a: one, b: one ***REMOVED***;
    t.equal(stringify(two), '{"a":{"x":1***REMOVED***,"b":{"x":1***REMOVED******REMOVED***');
***REMOVED***);

test('acyclic but with reused obj-property pointers', function (t) {
    t.plan(1);
    var x = { a: 1 ***REMOVED***;
    var y = { b: x, c: x ***REMOVED***;
    t.equal(stringify(y), '{"b":{"a":1***REMOVED***,"c":{"a":1***REMOVED******REMOVED***');
***REMOVED***);
