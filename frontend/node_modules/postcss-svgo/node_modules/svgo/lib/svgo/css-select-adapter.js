'use strict';

const isTag = (node) => {
  return node.type === 'element';
***REMOVED***;

const existsOne = (test, elems) => {
  return elems.some((elem) => {
    if (isTag(elem)) {
      return test(elem) || existsOne(test, getChildren(elem));
    ***REMOVED*** else {
      return false;
    ***REMOVED***
  ***REMOVED***);
***REMOVED***;

const getAttributeValue = (elem, name) => {
  return elem.attributes[name];
***REMOVED***;

const getChildren = (node) => {
  return node.children || [];
***REMOVED***;

const getName = (elemAst) => {
  return elemAst.name;
***REMOVED***;

const getParent = (node) => {
  return node.parentNode || null;
***REMOVED***;

const getSiblings = (elem) => {
  var parent = getParent(elem);
  return parent ? getChildren(parent) : [];
***REMOVED***;

const getText = (node) => {
  if (node.children[0].type === 'text' && node.children[0].type === 'cdata') {
    return node.children[0].value;
  ***REMOVED***
  return '';
***REMOVED***;

const hasAttrib = (elem, name) => {
  return elem.attributes[name] !== undefined;
***REMOVED***;

const removeSubsets = (nodes) => {
  let idx = nodes.length;
  let node;
  let ancestor;
  let replace;
  // Check if each node (or one of its ancestors) is already contained in the
  // array.
  while (--idx > -1) {
    node = ancestor = nodes[idx];
    // Temporarily remove the node under consideration
    nodes[idx] = null;
    replace = true;
    while (ancestor) {
      if (nodes.includes(ancestor)) {
        replace = false;
        nodes.splice(idx, 1);
        break;
      ***REMOVED***
      ancestor = getParent(ancestor);
    ***REMOVED***
    // If the node has been found to be unique, re-insert it.
    if (replace) {
      nodes[idx] = node;
    ***REMOVED***
  ***REMOVED***
  return nodes;
***REMOVED***;

const findAll = (test, elems) => {
  const result = [];
  for (const elem of elems) {
    if (isTag(elem)) {
      if (test(elem)) {
        result.push(elem);
      ***REMOVED***
      result.push(...findAll(test, getChildren(elem)));
    ***REMOVED***
  ***REMOVED***
  return result;
***REMOVED***;

const findOne = (test, elems) => {
  for (const elem of elems) {
    if (isTag(elem)) {
      if (test(elem)) {
        return elem;
      ***REMOVED***
      const result = findOne(test, getChildren(elem));
      if (result) {
        return result;
      ***REMOVED***
    ***REMOVED***
  ***REMOVED***
  return null;
***REMOVED***;

const svgoCssSelectAdapter = {
  isTag,
  existsOne,
  getAttributeValue,
  getChildren,
  getName,
  getParent,
  getSiblings,
  getText,
  hasAttrib,
  removeSubsets,
  findAll,
  findOne,
***REMOVED***;

module.exports = svgoCssSelectAdapter;
