"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
***REMOVED***);
exports.once = once;
var _async = require("./async.js");
function once(fn) {
  let result;
  let resultP;
  let promiseReferenced = false;
  return function* () {
    if (!result) {
      if (resultP) {
        promiseReferenced = true;
        return yield* (0, _async.waitFor)(resultP);
      ***REMOVED***
      if (!(yield* (0, _async.isAsync)())) {
        try {
          result = {
            ok: true,
            value: yield* fn()
          ***REMOVED***;
        ***REMOVED*** catch (error) {
          result = {
            ok: false,
            value: error
          ***REMOVED***;
        ***REMOVED***
      ***REMOVED*** else {
        let resolve, reject;
        resultP = new Promise((res, rej) => {
          resolve = res;
          reject = rej;
        ***REMOVED***);
        try {
          result = {
            ok: true,
            value: yield* fn()
          ***REMOVED***;
          resultP = null;
          if (promiseReferenced) resolve(result.value);
        ***REMOVED*** catch (error) {
          result = {
            ok: false,
            value: error
          ***REMOVED***;
          resultP = null;
          if (promiseReferenced) reject(error);
        ***REMOVED***
      ***REMOVED***
    ***REMOVED***
    if (result.ok) return result.value;else throw result.value;
  ***REMOVED***;
***REMOVED***
0 && 0;

//# sourceMappingURL=functional.js.map
