'use strict';

const AuthPrompt = require('../types/auth');

function defaultAuthenticate(value, state) {
  if (value.username === this.options.username && value.password === this.options.password) {
    return true;
  ***REMOVED***
  return false;
***REMOVED***

const factory = (authenticate = defaultAuthenticate) => {
  const choices = [
    { name: 'username', message: 'username' ***REMOVED***,
    {
      name: 'password',
      message: 'password',
      format(input) {
        if (this.options.showPassword) {
          return input;
        ***REMOVED***
        let color = this.state.submitted ? this.styles.primary : this.styles.muted;
        return color(this.symbols.asterisk.repeat(input.length));
      ***REMOVED***
    ***REMOVED***
  ];

  class BasicAuthPrompt extends AuthPrompt.create(authenticate) {
    constructor(options) {
      super({ ...options, choices ***REMOVED***);
    ***REMOVED***

    static create(authenticate) {
      return factory(authenticate);
    ***REMOVED***
  ***REMOVED***

  return BasicAuthPrompt;
***REMOVED***;

module.exports = factory();
